{"version":3,"sources":["gun.js"],"names":["rocker","require","cc","Class","extends","Component","properties","type","default","bullet_Prefab","Prefab","onLoad","Canvas","find","hero","arm_len","start","update","dt","dir","rocker_rot","radius","Math","PI","node","rotation","update_gun_position","revise_x","revise_y","arm_len_x","cos","arm_len_y","sin","x","y","fire","bullet","instantiate","addChild","parent_pos","parent","position","bullet_pos","v2","setPosition"],"mappings":"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","file":"gun.js","sourceRoot":"../../../../../../assets/scripts/game/hero","sourcesContent":["var rocker = require(\"rocker\");// 将摇杆这个类拿过来用\n\n// *-*-*-*-*-*-*-* 英雄节点 *-*-*-*-*-*-*-*-*\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 摇杆对象\n        rocker:{\n            type: rocker,\n            default: null,\n        },\n\n        // 子弹\n        bullet_Prefab: {\n            default: null,\n            type: cc.Prefab\n        },\n    },\n\n    onLoad () {\n        this.Canvas=cc.find(\"Canvas\");\n        this.hero=cc.find(\"Canvas/hero\");\n        this.arm_len = 50;// 手臂长度\n    },\n\n    start () {},\n\n    update (dt) {\n        if(this.rocker.dir===-1){\n            return;// 如果摇杆dir为-1 说明摇杆没有触摸\n        }\n        // 更新枪的角度\n        this.rocker_rot = 180 * this.rocker.radius / Math.PI;// 获取摇杆的角度\n        this.node.rotation = 90 - this.rocker_rot;// 设置枪的角度\n\n        // 更新枪的位置\n        this.update_gun_position();\n\n        // 根据选择改变枪的精灵帧(换枪)\n    },\n\n    // 更新枪的位置(设置枪到手上)\n    update_gun_position(){\n        \n\n        if(this.rocker.dir==1||this.rocker.dir==5){// 上下\n            this.arm_len = 40;\n            this.revise_x=0;// 校正枪的位置\n            this.revise_y=0;\n        }\n        else if(this.rocker.dir==2||this.rocker.dir==8){// 上左右\n            this.arm_len = 65;\n            this.revise_x=0;\n            this.revise_y=-5;\n        }\n        else if(this.rocker.dir==4||this.rocker.dir==6){// 下左右\n            this.arm_len = 60;\n            this.revise_x=0;\n            this.revise_y=30;\n        }\n        else{// 左右\n            this.arm_len = 55;\n            this.revise_x=0;\n            this.revise_y=10;\n        }\n\n        // this.arm_len=5;// 手臂长度分解\n        this.arm_len_x = this.arm_len * Math.cos(this.rocker.radius);\n        this.arm_len_y = this.arm_len * Math.sin(this.rocker.radius);\n\n        // 更新枪的位置\n        this.node.x = this.arm_len_x + this.revise_x;\n        this.node.y = this.arm_len_y + this.revise_y;\n    },\n\n    // 开火\n    fire(){\n        // 创建子弹\n        var bullet = cc.instantiate(this.bullet_Prefab);\n        // 将新增的节点添加到 Canvas 节点下面\n        this.Canvas.addChild(bullet);\n        // console.log(this.node.parent.position);// 英雄位置\n        // console.log(this.node.position);// 枪在父节点的位置\n        this.parent_pos=this.node.parent.position;\n        // 子弹Canvas坐标的位置\n        this.bullet_pos=cc.v2(this.parent_pos.x+this.node.position.x,this.parent_pos.y+this.node.position.y);\n        bullet.setPosition(this.bullet_pos);\n        // 角度为枪的角度\n        bullet.rotation=this.node.rotation;\n\n        // newGuang.getComponent('Guang').game = this;\n    },\n});\n"]}